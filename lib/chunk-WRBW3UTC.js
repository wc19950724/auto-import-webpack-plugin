'use strict';

var _ = require('fs');
var v = require('path');

function _interopDefault (e) { return e && e.__esModule ? e : { default: e }; }

var ___default = /*#__PURE__*/_interopDefault(_);
var v__default = /*#__PURE__*/_interopDefault(v);

var Pt=Object.create;var I=Object.defineProperty;var Lt=Object.getOwnPropertyDescriptor;var Nt=Object.getOwnPropertyNames;var It=Object.getPrototypeOf,jt=Object.prototype.hasOwnProperty;var $=(t=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(t,{get:(e,o)=>(typeof require!="undefined"?require:e)[o]}):t)(function(t){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')});var b=(t,e)=>()=>(t&&(e=t(t=0)),e);var K=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),kt=(t,e)=>{for(var o in e)I(t,o,{get:e[o],enumerable:!0});},Tt=(t,e,o,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of Nt(e))!jt.call(t,r)&&r!==o&&I(t,r,{get:()=>e[r],enumerable:!(n=Lt(e,r))||n.enumerable});return t};var j=(t,e,o)=>(o=t!=null?Pt(It(t)):{},Tt(e||!t||!t.__esModule?I(o,"default",{value:t,enumerable:!0}):o,t));var Y=(t,e,o)=>{if(!e.has(t))throw TypeError("Cannot "+o)};var me=(t,e,o)=>(Y(t,e,"read from private field"),o?o.call(t):e.get(t)),ue=(t,e,o)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,o);},xe=(t,e,o,n)=>(Y(t,e,"write to private field"),n?n.call(t,o):e.set(t,o),o);var d=(t,e,o)=>new Promise((n,r)=>{var s=p=>{try{c(o.next(p));}catch(g){r(g);}},i=p=>{try{c(o.throw(p));}catch(g){r(g);}},c=p=>p.done?n(p.value):Promise.resolve(p.value).then(s,i);c((o=o.apply(t,e)).next());});var T=K((he,k)=>{var Ft=$("tty"),Gt=!("NO_COLOR"in process.env||process.argv.includes("--no-color"))&&("FORCE_COLOR"in process.env||process.argv.includes("--color")||process.platform==="win32"||Ft.isatty(1)&&process.env.TERM!=="dumb"||"CI"in process.env),a=(t,e,o=t)=>n=>{let r=""+n,s=r.indexOf(e,t.length);return ~s?t+J(r,e,o,s)+e:t+r+e},J=(t,e,o,n)=>{let r=t.substring(0,n)+o,s=t.substring(n+e.length),i=s.indexOf(e);return ~i?r+J(s,e,o,i):r+s},U=(t=Gt)=>({isColorSupported:t,reset:t?e=>`\x1B[0m${e}\x1B[0m`:String,bold:t?a("\x1B[1m","\x1B[22m","\x1B[22m\x1B[1m"):String,dim:t?a("\x1B[2m","\x1B[22m","\x1B[22m\x1B[2m"):String,italic:t?a("\x1B[3m","\x1B[23m"):String,underline:t?a("\x1B[4m","\x1B[24m"):String,inverse:t?a("\x1B[7m","\x1B[27m"):String,hidden:t?a("\x1B[8m","\x1B[28m"):String,strikethrough:t?a("\x1B[9m","\x1B[29m"):String,black:t?a("\x1B[30m","\x1B[39m"):String,red:t?a("\x1B[31m","\x1B[39m"):String,green:t?a("\x1B[32m","\x1B[39m"):String,yellow:t?a("\x1B[33m","\x1B[39m"):String,blue:t?a("\x1B[34m","\x1B[39m"):String,magenta:t?a("\x1B[35m","\x1B[39m"):String,cyan:t?a("\x1B[36m","\x1B[39m"):String,white:t?a("\x1B[37m","\x1B[39m"):String,gray:t?a("\x1B[90m","\x1B[39m"):String,bgBlack:t?a("\x1B[40m","\x1B[49m"):String,bgRed:t?a("\x1B[41m","\x1B[49m"):String,bgGreen:t?a("\x1B[42m","\x1B[49m"):String,bgYellow:t?a("\x1B[43m","\x1B[49m"):String,bgBlue:t?a("\x1B[44m","\x1B[49m"):String,bgMagenta:t?a("\x1B[45m","\x1B[49m"):String,bgCyan:t?a("\x1B[46m","\x1B[49m"):String,bgWhite:t?a("\x1B[47m","\x1B[49m"):String});k.exports=U();k.exports.createColors=U;});var ct=K((ye,it)=>{function Q(t){return Array.isArray(t)?t:[t]}var ot="",Z=" ",F="\\",Mt=/^\s+$/,Dt=/(?:[^\\]|^)\\$/,Bt=/^\\!/,Vt=/^\\#/,Xt=/\r?\n/g,qt=/^\.*\/|^\.+$/,G="/",nt="node-ignore";typeof Symbol!="undefined"&&(nt=Symbol.for("node-ignore"));var tt=nt,Ht=(t,e,o)=>Object.defineProperty(t,e,{value:o}),Wt=/([0-z])-([0-z])/g,rt=()=>!1,zt=t=>t.replace(Wt,(e,o,n)=>o.charCodeAt(0)<=n.charCodeAt(0)?e:ot),Kt=t=>{let{length:e}=t;return t.slice(0,e-e%2)},Yt=[[/\\?\s+$/,t=>t.indexOf("\\")===0?Z:ot],[/\\\s/g,()=>Z],[/[\\$.|*+(){^]/g,t=>`\\${t}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return /\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(t,e,o)=>e+6<o.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(t,e,o)=>{let n=o.replace(/\\\*/g,"[^\\/]*");return e+n}],[/\\\\\\(?=[$.|*+(){^])/g,()=>F],[/\\\\/g,()=>F],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(t,e,o,n,r)=>e===F?`\\[${o}${Kt(n)}${r}`:r==="]"&&n.length%2===0?`[${zt(o)}${n}]`:"[]"],[/(?:[^*])$/,t=>/\/$/.test(t)?`${t}$`:`${t}(?=$|\\/$)`],[/(\^|\\\/)?\\\*$/,(t,e)=>`${e?`${e}[^/]+`:"[^/]*"}(?=$|\\/$)`]],et=Object.create(null),Jt=(t,e)=>{let o=et[t];return o||(o=Yt.reduce((n,r)=>n.replace(r[0],r[1].bind(t)),t),et[t]=o),e?new RegExp(o,"i"):new RegExp(o)},B=t=>typeof t=="string",Ut=t=>t&&B(t)&&!Mt.test(t)&&!Dt.test(t)&&t.indexOf("#")!==0,Qt=t=>t.split(Xt),M=class{constructor(e,o,n,r){this.origin=e,this.pattern=o,this.negative=n,this.regex=r;}},Zt=(t,e)=>{let o=t,n=!1;t.indexOf("!")===0&&(n=!0,t=t.substr(1)),t=t.replace(Bt,"!").replace(Vt,"#");let r=Jt(t,e);return new M(o,t,n,r)},te=(t,e)=>{throw new e(t)},h=(t,e,o)=>B(t)?t?h.isNotRelative(t)?o(`path should be a \`path.relative()\`d string, but got "${e}"`,RangeError):!0:o("path must not be empty",TypeError):o(`path must be a string, but got \`${e}\``,TypeError),st=t=>qt.test(t);h.isNotRelative=st;h.convert=t=>t;var D=class{constructor({ignorecase:e=!0,ignoreCase:o=e,allowRelativePaths:n=!1}={}){Ht(this,tt,!0),this._rules=[],this._ignoreCase=o,this._allowRelativePaths=n,this._initCache();}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null);}_addPattern(e){if(e&&e[tt]){this._rules=this._rules.concat(e._rules),this._added=!0;return}if(Ut(e)){let o=Zt(e,this._ignoreCase);this._added=!0,this._rules.push(o);}}add(e){return this._added=!1,Q(B(e)?Qt(e):e).forEach(this._addPattern,this),this._added&&this._initCache(),this}addPattern(e){return this.add(e)}_testOne(e,o){let n=!1,r=!1;return this._rules.forEach(s=>{let{negative:i}=s;if(r===i&&n!==r||i&&!n&&!r&&!o)return;s.regex.test(e)&&(n=!i,r=i);}),{ignored:n,unignored:r}}_test(e,o,n,r){let s=e&&h.convert(e);return h(s,e,this._allowRelativePaths?rt:te),this._t(s,o,n,r)}_t(e,o,n,r){if(e in o)return o[e];if(r||(r=e.split(G)),r.pop(),!r.length)return o[e]=this._testOne(e,n);let s=this._t(r.join(G)+G,o,n,r);return o[e]=s.ignored?s:this._testOne(e,n)}ignores(e){return this._test(e,this._ignoreCache,!1).ignored}createFilter(){return e=>!this.ignores(e)}filter(e){return Q(e).filter(this.createFilter())}test(e){return this._test(e,this._testCache,!0)}},R=t=>new D(t),ee=t=>h(t&&h.convert(t),t,rt);R.isPathValid=ee;R.default=R;it.exports=R;if(typeof process!="undefined"&&(process.env&&process.env.IGNORE_TEST_WIN32||process.platform==="win32")){let t=o=>/^\\\\\?\\/.test(o)||/["<>|\u0000-\u001F]+/u.test(o)?o:o.replace(/\\/g,"/");h.convert=t;let e=/^[a-z]:\//i;h.isNotRelative=o=>e.test(o)||st(o);}});var at,S,A;exports.k = void 0;var f;exports.l = void 0;var x,ft,E,pt,V,lt,y,X,mt,q,ut,xt,H,dt=b(()=>{at=j(ct());O();S=process.cwd(),A={config:"atconfig.js"},exports.k={entry:".",output:"auto-import.js",library:"element-ui",ignore:".autoignore",logLevel:!0},f=exports.k,exports.l=t=>d(void 0,null,function*(){var e;if(Object.assign(f,t),!Array.isArray(f.ignore)){let o="";if(typeof f.ignore=="string"?o=v__default.default.resolve(S,f.ignore):(e=f.ignore)!=null&&e.path&&(o=v__default.default.resolve(S,f.ignore.path)),___default.default.existsSync(o)){let n=___default.default.readFileSync(o).toString().replace(/\/$/gm,"");ft.add(n);}}}),x=()=>f,ft=(0, at.default)().add("node_modules").add("/.*"),E=t=>{if(typeof f.ignore=="string")return !1;let e;if(Array.isArray(f.ignore)?e=f.ignore:f.ignore.components&&(e=f.ignore.components),e)for(let o of e){if(o instanceof RegExp)return o.test(t);if(typeof o=="string")return X(o)===t}return !1},pt=()=>v__default.default.resolve(process.cwd(),f.entry),V=()=>v__default.default.resolve(S,f.output),lt=16,y=t=>l.success(`
[AUTO] ${t}`),X=t=>t.replace(/(?:^|-)(\w)/g,(e,o)=>o.toUpperCase()),mt=()=>{let t=V(),e=new Set;if(___default.default.existsSync(t)){let o=___default.default.readFileSync(t,"utf8"),n=/import\s*{([^}]*)}\s*from\s*['"]([^'"]*)['"]/g,r=o.matchAll(n);for(let s of r)s[1].split(",").map(c=>c.trim()).filter(Boolean).forEach(c=>{e.add(c);});}return e},q=t=>{let e=___default.default.readdirSync(t,{withFileTypes:!0}),o=[];return e.forEach(n=>{if(ft.ignores(n.name))return;let r=v__default.default.resolve(t,n.name),s=___default.default.statSync(r);s.isDirectory()?o.push(...q(r)):s.isFile()&&n.name.endsWith(".vue")&&(l.gray(r),o.push(r));}),o},ut=t=>{let e=Object.keys(t).reduce((o,n)=>n.length>o?n.length:o,0);return (o,n=" ")=>o.padEnd(e,n)},xt=(t,e)=>e instanceof RegExp?String(e):e,H=t=>{let e=t;if(Array.isArray(t))e=t.map(o=>H(o));else if(typeof t=="string"&&t.startsWith("/")&&t.lastIndexOf("/")>0){let o=t.slice(t.lastIndexOf("/")+1),n=t.slice(1,t.lastIndexOf("/"));e=new RegExp(n,o);}return e};});var l={};kt(l,{default:()=>oe,error:()=>ht,gray:()=>Et,info:()=>St,log:()=>_t,success:()=>bt,warn:()=>yt});var C,ht,yt,St,bt,_t,Et,oe,Ot=b(()=>{C=j(T());O();ht=t=>{let{logLevel:e}=x();e&&["error","warn","info",!0].indexOf(e)>-1&&console.log(C.default.red(t));},yt=t=>{let{logLevel:e}=x();e&&["warn","info",!0].indexOf(e)>-1&&console.log(C.default.yellow(t));},St=t=>{let{logLevel:e}=x();e&&["info",!0].indexOf(e)>-1&&console.log(C.default.blue(t));},bt=t=>{let{logLevel:e}=x();e&&["info",!0].indexOf(e)>-1&&console.log(C.default.green(t));},_t=(...t)=>{let{logLevel:e}=x();e&&["info",!0].indexOf(e)>-1&&console.log(...t);},Et=t=>{let{logLevel:e}=x();e&&["info",!0].indexOf(e)>-1&&console.log(C.default.gray(t));},oe={error:ht,warn:yt,info:St,success:bt,log:_t,gray:Et};});var O=b(()=>{Ct();dt();Ot();});var z;exports.g = void 0;var $t;exports.h = void 0;var ne;exports.i = void 0;exports.j = void 0;var Ct=b(()=>{z=j(T());O();exports.g={"--help":Boolean,"--version":Boolean,"--config":String,"-h":"--help","-v":"--version","-c":"--config"},$t=t=>d(void 0,null,function*(){var r;let e={},o=v__default.default.join(S,t),n=v__default.default.extname(t).slice(1);if(___default.default.existsSync(o)){if(n==="json"){let s=___default.default.readFileSync(o,"utf8"),i=JSON.parse(s);for(let c in i)i[c]=H(i[c]);Object.assign(e,i);}else if(n==="js"){let s=$(o);Object.assign(e,s);}}else {let s="",i=JSON.stringify(exports.k,xt,2);if(n==="json"?s=i:n==="js"&&(s=`module.exports = ${i.replace(/"([^"]+)":/g,"$1:").replace(/"([^"]+)"/g,(m,u)=>{if(u.startsWith("/")&&u.lastIndexOf("/")>0){let wt=u.slice(u.lastIndexOf("/")+1);return `/${u.slice(1,u.lastIndexOf("/"))}/${wt}`}else return m})}`),!s)throw new Error("write config is failed",{cause:t});let{ESLint:c}=$("eslint"),g=yield new c({fix:!0,cache:!0}).lintText(s);s=((r=g==null?void 0:g[0])==null?void 0:r.output)||s,___default.default.writeFileSync(o,s),y("generating default config"),l.gray(o),Object.assign(e,exports.k);}return e}),exports.h=t=>d(void 0,null,function*(){let e={};for(let o in t)if(o==="--config"){let n=t[o]||A.config;Object.assign(e,yield $t(n));}if(!Object.keys(e).length){let o=A.config;Object.assign(e,yield $t(o));}return e}),ne=t=>{let e="";switch(t){case"-h":e="cli help";break;case"-v":e="package version";break;case"-c":e="config filename".padEnd(lt)+`default: '${A.config}'`;break;}return e},exports.i=()=>{let t=new Map;for(let o in exports.g){let n=exports.g[o];exports.g[n]?(t.set(`${o}, ${n}`,o),t.delete(o),t.delete(`${n}`)):t.set(o,o);}let e=ut(Object.fromEntries(t));for(let[o,n]of t)l.warn(`${e(o)}: ${z.default.bold(ne(n))}`);},exports.j=()=>{let t=v__default.default.join(v__default.default.dirname(__dirname),"..","package.json"),e=JSON.parse(___default.default.readFileSync(t,"utf-8"));l.success(z.default.bold(e.version));};});var se,vt,ie,Rt,At=b(()=>{O();se={Loading:{use:"Loading.directive",prototype:{loading:"Loading.service"}},MessageBox:{prototype:{msgbox:"MessageBox",alert:"MessageBox.alert",confirm:"MessageBox.confirm",prompt:"MessageBox.prompt"}},Notification:{prototype:{notify:"Notification"}},Message:{prototype:{message:"Message"}}},vt=t=>{let e=new Set,o=_.readFileSync(t,"utf-8"),n=/<(?:el-|El)([^>\s]+)(?=[\s>])/g,r=/\bv-loading(?::[^=>\s]+)?/g,s=/\$(?:msgbox|alert|confirm|prompt|notify|message)/g,i=o.matchAll(n),c=new Set;for(let g of i){let m=g[1],u=X(m);if(E(u)){c.add(u);continue}e.add(u);}if(E("Loading"))c.add("Loading");else {let g=o.match(r);g!=null&&g.length&&e.add("Loading");}let p=o.matchAll(s);for(let g of p){let m=g[0].substring(1);if(m==="msgbox"||m==="alert"||m==="confirm"||m==="prompt"){if(E("MessageBox")){c.add("MessageBox");continue}e.add("MessageBox");}else if(m==="notify"){if(E("Notification")){c.add("Notification");continue}e.add("Notification");}else if(m==="message"){if(E("Message")){c.add("Message");continue}e.add("Message");}}if(c.size>0){y("Ignore Components");for(let g of c)l.gray(g);}return e},ie=t=>{let e=se[t];if(!e)return `Vue.use(${t})`;let{use:o,prototype:n}=e,r=[];if(o&&r.push(`Vue.use(${o});`),n){let s=Object.entries(n).map(([i,c])=>`Vue.prototype.$${i} = ${c};`);r.push(...s);}return r.join(`
`)},Rt=t=>{let e=`import { ${Array.from(t).join()} } from "element-ui"`,o=Array.from(t).map(ie);return `
    ${e}
    import Vue from "vue"
    
    // \u5168\u5C40\u6309\u9700\u5BFC\u5165\u7684\u7EC4\u4EF6\u5217\u8868
    ${o.join(`
`)}
  `};});exports.o = void 0;var ge,fe;exports.p = void 0;var pe=b(()=>{At();O();exports.o=()=>d(void 0,null,function*(){let t=x();y("scanning files...");let e=mt(),o=q(pt()),n=new Set;t.library==="element-ui"&&o.forEach(s=>{let i=vt(s);for(let c of i)n.add(c);});let r=n.size!==e.size;if(!r){for(let s of n)if(!e.has(s)){r=!0;break}}if(!r){y("no update required");return}yield ge(n);}),ge=t=>d(void 0,null,function*(){var c;let e=x();y(`generating ${e.output}...`);let o=V(),n="";e.library==="element-ui"&&(n=Rt(t));let{ESLint:r}=$("eslint"),i=yield new r({fix:!0,cache:!0}).lintText(n);if(n=((c=i==null?void 0:i[0])==null?void 0:c.output)||n,___default.default.existsSync(o))___default.default.unlinkSync(o);else {let p=v__default.default.dirname(o);p!==S&&___default.default.mkdirSync(p,{recursive:!0});}___default.default.writeFileSync(o,n),y(`${e.output} genarated!`);}),fe=t=>d(void 0,null,function*(){yield exports.l(t),yield exports.o();}),exports.p=fe;});

exports.a = K;
exports.b = j;
exports.c = me;
exports.d = ue;
exports.e = xe;
exports.f = d;
exports.m = l;
exports.n = O;
exports.q = pe;
